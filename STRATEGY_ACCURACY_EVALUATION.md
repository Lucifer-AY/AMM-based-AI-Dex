# Strategy Accuracy Evaluation

This document explains how strategy accuracy was evaluated for the Crypto Trading Agent, including the process, evaluation basis, and data source.

## 1) Objective

The goal is to evaluate whether the **strategy output** generated by the agent (BUY/SELL/HOLD style guidance) is directionally trustworthy when compared against future market movement.

This is a **historical backtest-based directional accuracy evaluation**, not a guarantee of future performance.

---

## 2) Data Source

Evaluation data is fetched from the existing project data pipeline:

- Module: `data_fetcher.py`
- Function: `get_historical_data(symbol, days, interval='1d')`
- Primary source: **CoinGecko OHLC API**
- Symbols evaluated in latest run: `BTC`, `ETH`, `SOL`, `ADA`
- Backtest window in latest run: `365` days
- Candle granularity: daily candles

OHLC columns used:

- `timestamp`
- `open`
- `high`
- `low`
- `close`
- `volume` (present in pipeline; current free OHLC flow may provide limited volume)

---

## 3) Evaluation Script Used

- Script: `strategy_accuracy_evaluation.py`
- Command used:

```bash
python strategy_accuracy_evaluation.py --symbols BTC ETH SOL ADA --days 365 --horizon 7 --warmup 40
```

Output report generated:

- `reports/strategy_accuracy_report.json`

---

## 4) Evaluation Process

For each symbol:

1. Fetch historical OHLC data.
2. Start after warmup period (`warmup=40`) so technical context is available.
3. At each evaluation timestamp:
   - Build market features from current and recent candles.
   - Run technical analysis (`TechnicalAnalyzer`) on available history.
   - Compute RL signal (`RLPredictor.predict_signal(...)`).
   - Compute momentum signal (aligned with project dual-signal logic).
   - Combine momentum + RL into final signal:
     - `strong_buy`, `buy`, `hold`, `sell`, `strong_sell`
4. Compare final signal with **future return** over evaluation horizon (`horizon=7 days`).
5. Mark signal as correct/incorrect using the hold threshold band (`hold_band=1.5%`).
6. Aggregate accuracy and diagnostic metrics over all evaluated points.

---

## 5) Basis of Accuracy Scoring

A signal is considered **correct** using the following directional rules:

- **BUY / STRONG_BUY** is correct if future return > `+1.5%`
- **SELL / STRONG_SELL** is correct if future return < `-1.5%`
- **HOLD** is correct if absolute future return <= `1.5%`

These thresholds are set to reduce noise from tiny moves and provide practical directional classification.

---

## 6) Metrics Reported

The report includes:

- `accuracy_pct`: percentage of correct directional calls
- `signals_distribution`: frequency of each strategy signal
- `accuracy_by_confidence`: accuracy split by confidence bucket (low/medium/high)
- `strategy_mean_return_pct`: mean per-signal signed return proxy
- `strategy_median_return_pct`: median per-signal signed return proxy
- `market_mean_forward_return_pct`: mean raw forward market return over the same horizon
- `profit_factor`: gross-positive divided by gross-negative strategy return proxy

---

## 7) Latest Run Result (Current)

From `reports/strategy_accuracy_report.json`:

- Total evaluated signals: `180`
- Overall strategy accuracy: **`52.22%`**
- Verdict: **`moderate`** trustworthiness

Per symbol accuracy:

- BTC: `51.11%`
- ETH: `42.22%`
- SOL: `55.56%`
- ADA: `60.00%`

Interpretation:

- The strategy is **mixed/moderate** in directional reliability.
- It is better than pure random in some symbols/time slices but not consistently strong.
- Outputs should be used with strict risk controls and not as standalone financial advice.

---

## 8) Important Limitations

1. This is a historical backtest, not live forward testing.
2. Market regime changes can reduce future reliability.
3. Accuracy is sensitive to horizon and hold-band thresholds.
4. Overlapping windows can correlate test points.
5. Transaction costs/slippage are not modeled in this directional evaluation.

---

## 9) Recommended Next Improvements

- Add strict out-of-sample split (train period vs test period).
- Evaluate multiple horizons (1d, 3d, 7d, 14d).
- Add fees/slippage assumptions.
- Track calibration: confidence vs realized hit-rate.
- Add rolling monthly accuracy monitoring report.

---

## 10) Files Involved

- Strategy evaluator: `strategy_accuracy_evaluation.py`
- Output report: `reports/strategy_accuracy_report.json`
- RL predictor: `rl_predictor.py`
- Data source module: `data_fetcher.py`
- Technical analysis module: `technical_analysis.py`
